#### test_task

# Web-server on pure C-language in Docker container without external libraries.

### Запуск сервера
`make run` запустит веб сервер на 8085 порту, директория с html файлами будет `./src/templates/`<br>

### Аргументы командной строки
`-p --port` задать любой свободный порт от 1 до 65535 (по дефолту 8085) <br>
`-d -directory` задать директорию, в которой сервер будет искать html файл(по дефолту ./srd/templates/) <br>

Аргументы можно задать в переменной `ARGS`, при вызове `make run` <br>
`make run ARGS="-p 4422 -d ./"` запустит веб сервер на порту 4422, и html файлы будет искать в текущей директории<br>

### Запросы
Сервер на любой вид запросов(кроме DELETE) ищет запрашиваемый .html файл в указанной при запуске директории и, если
находит, то отправляет содержимое в ответ<br>

`http://127.0.0.1:8085/about_me.html` запросы можно отправлять через строку браузера, достаточно вписать подобный адрес
в командную строку<br>
`curl http://127.0.0.1:8085/hello.html` также можно отправлять запрос через терминал, используя утилиту curl<br>
`curl -X DELETE http://127.0.0.1:8085/hello.html` на сервере реализовано функция удаления файла при помощи следующего
запроса<br>

### Docker
Так как осталось время на выполнение тестового задания, решил поместить веб-сервер в контейнер ubuntu:20.04 <br>
`docker-compose up` запускает сервер в Docker контейнере на порте 8085, директория с файлами по
дефолту `/server/src/templates/`<br>
Эта директория примонтирована к аналогичной директории на локальной машине<br>

Если потребуется более детальная настройка портов, то можно собрать докер "вручную":<br>
`docker build -t web_c .` для сборки образа необходимо вызвать эту команду из корневой директории проекта <br>
`docker run --name test -it -v $(pwd)/src/templates:/server/src/templates -d -p 8082:8085 web_c` далее можно запускать
сервер <br>

В данной конфигурации запросы можно отправлять на 8082 порт машины, сервер внутри контейнера будет запущен на 8085
порту <br>
`docker exec -it test make test` для запуска тестов внутри докер контейнера достаточно вызвать <br>

### Тесты
- `make test` запускает модульные тесты реализованные с помощью библиотеки -lcheck на локальной машине<br>
- `pytest` запустит тесты веб-сервера.<br>
  ВАЖНО! Чтобы корректно отработали тесты, необходимо запустить веб-сервер в докере<br>
  на дефолтном порту 8082, с привязкой к дефолтной директории ./src/templates<br>
- `make docker-test` запустит модульные тесты в докере, перед выполнением этой команды, необходимо также поднять
  веб-сервер в Docker<br>

### Makefile
- `run` запускает сервер на локальной машине<br>
- `build` сборка объектных файлы<br>
- `test` запускает тесты на локальной машине<br>
- `docker-test` запускает тесты внутри докер-контейнера<br>
- `create_lib` собирает статическую библиотеку из функций http и cnet<br>
- `clean` удаляет исполняемые и объектные файлы<br>
